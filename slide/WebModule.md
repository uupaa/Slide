% 新しいモジュールパターン WebModule について
% Web Application Module.
% @uupaa - 2014-03-20

<!-- ----------------------------------------------------- -->

<!-- ----------------------------------------------------- -->

# このスライドでは

- とある Webゲーム開発現場の抱える課題
- [WebModule][] の導入で解決できること

について説明します


<!-- ----------------------------------------------------- -->

# Webゲーム開発現場の現状

## **ワークフローが確立されていない**

- 各自バラバラのスタイルでコードを書いている
- 力量がコードにそのまま反映されてしまう
- 他のプロジェクトにコードを簡単に流用できない
- npm を使ったモジュールの仕組みが利用されていない


## **テストや<br />ドキュメントの品質がバラバラ**

- テストは基本的に期待できない
- ドキュメントがあったらラッキー
- ドキュメントはあるけれど、中身がスカスカ
- JSDoc で自分好みのテンプレート
- 「動けばいい」で、そのまま放置されている

**だって忙しいから**

## **JavaScript で大規模開発?**

- チーム開発を理解してて
- エンタープライズ品質を理解してて
- JavaScript を書けて
- エンジニアリングできて
- 自走できる人間を一個小隊用意する?
- そんな人どこにいるの
- 社内に数人いれば良いほうじゃない?
- AltJS を使う/使わない以前の問題

**今のままでは、大規模開発なんて夢です。夢**

## それにしても酷いもんだ

- 転職する人がコードだけを残していく
- 引継ぎがコストフル。ストレスが半端ない
- それを食わされる新人のSAN値が **やばい**
- ついには **新人の血を吸って** 魔物化するコードが現れる

## もう見て見ぬふりはできない

- **書き逃げはゆるさん**
- **ドキュメントを書かない奴にはコードを書かせるな**
- 不幸の連鎖は何処かで断ち切る必要がある

という、大変ツライ状況に発展することも

## こうならないようにするには、<br />どうすれば?

余計な事に心を乱されず、本質的な作業に集中するためには、どうすればよいのか?


<!-- ----------------------------------------------------- -->

# 課題を解決しよう

## 雛形を用意したらどうだろう

- コードを書く上での雛形(フォーマット)を用意しよう
- 雛形から開発をスタートできるようにしよう

## テストを何とかしよう

- テストを書きやすくしたい
- テストランナーを最初から提供しよう
- コマンドを叩くだけで、Node.js, Browser, WebWorkers で自動的にテストが走るようにしよう

## ドキュメントを何とかしよう

- 忙しい時は仕方ない
- 仕方ないので、細切れの時間を使って書いたり見たりできるようにしたい
- JSDoc はコードとドキュメントが癒着しているため、  
  フィーチャーフリーズした状態のコードは、ドキュメントも更新されずに放置される
- いっその事 JSDoc は止めて、コードとドキュメントを分離すると何かが変わるのではないか

## リファレンスを何とかしよう

- ブラウザと連携して何かできないか
- ブラウザの DevTools からキーワード検索ができると便利

## 実行速度や品質をなんとかしよう

- 実行速度を改善するために Closure Compiler の ADVANCED モードでコンパイルしたい
- コードに点数をつけたい
- 履歴を見れるようにしたい

## もっと利用してもらいたい

- OSS化しないと、休日に自宅で試す事もできず、結局社内でも利用されないハメに
- せっかく作ったのに、社内に塩漬けにされるのは忍びない
- ドキュメントは GitHub/Wiki(Markdown) に置いたほうがメリットがある
- 守りたい部分は従来通り GHE で管理し、外に出せる部分は積極的に出していきたい

## これらの課題は

WebModule の導入で一部解決できます

<!-- ----------------------------------------------------- -->

# WebModule が提供する<br />ソリューション

## 簡単・軽量・どこでも動く

- モジュールの雛形を提供。簡単に開発を始められる
- Closure Complier で実行速度とサイズを最適化したコンパイルを可能にする
- Node.js, Browser, WebWorkers で動作するコードが書ける

## テスト・ドキュメント・カバレッジ

- どこでも動作する事をテストで保証する仕組みを提供する
- 1ファイル, 1クラス  
  テストできないコードは、テスト可能な単位に分解するように仕向ける
- コードとドキュメント(リファレンス)を分離して記述させる
- ドキュメントを GitHub/wiki(Markdown) に記述させる
- JSHint, Plato で静的解析。結果をグラフで表示する

## 運用・教育・引継ぎ

- フォーマットとマニュアルを提供する。安心して乗っかれるようにする
- JavaScript 初心者でも、コマンドを幾つか叩くだけで、  
  「俺スゲー」感を味わえるようにする
- 最初の一歩をできるだけ簡単にする
- 引継ぎ可能な状態にする。
  テストとドキュメントがある状態を維持するように仕向ける

## ルーチンワーク化の促進

- コードの品質のボトムアップと、作業の標準化
- 作業が標準化されルーチンワーク化すれば、突然の火消し要請にも対応可能に  

<hr />
作業手順がチーム毎にバラバラな状態では、  
火消しのために増員してもすぐには作業できる状態になりません。  
コミュニケーションロスが増えるだけで、  
かえって逆効果になります

<!-- ----------------------------------------------------- -->

# 解決できないこと

## 一緒にビルドできないコードがある

- [ADVANCEDモード](https://code.google.com/p/closure-compiler/)に対応していないコードは壊れます
- [ビルド対象のコードが不明](https://github.com/uupaa/WebModule/wiki/package.json#wiki-build) な場合もビルドできません
- 一緒にビルドできない場合は、これまで通り、個別に読み込んで利用することに

```js
<script src="underscore.min.js"></script>
<script src="WebModules.min.js"></script>
<script src="App.min.js"></script>
```
```js
var _ = require("underscore.min.js");
var Lib = require("./WebModules.min.js");
var App = require("./App.min.js");
```

<!-- ----------------------------------------------------- -->

# WebModule の実装例

[uupaaのリポジトリ](https://github.com/uupaa?tab=repositories) に30個ほど  

これからさらに100個ほど増やす予定です

<!-- ----------------------------------------------------- -->

#

ぜひ、[WebModule][] を使ったモジュールを書いてください!

----
さらに詳しく知りたい方は

- [WebModule][]
- [WebModuleワークフロー][]
- [WebModuleコードパターン][]

をご覧ください

[WebModule]: https://github.com/uupaa/WebModule/wiki/WebModule
[WebModuleワークフロー]: https://github.com/uupaa/WebModule/wiki/WebModuleWorkflow
[WebModuleコードパターン]: https://github.com/uupaa/WebModule/wiki/WebModuleCodePattern

